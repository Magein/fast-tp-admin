<script>
    $(function () {
        // 绑定时间插件
        (function () {
            let date_time_input_num = 1;
            $('input.date-time-field').each(function () {
                /**
                 * 这里使用了动态设置id的属性,使用样式(.)选择器的话多个时间框的时候只有第一个能用
                 * @type {string}
                 */
                let id = 'datetime-field-' + date_time_input_num;
                $(this).attr('id', id);

                /**
                 * 获取时间格式,通过input的date-format设置
                 * @type {jQuery}
                 */
                let dateFormat = $(this).attr('date-format');
                if (dateFormat === '') {
                    dateFormat = 'datetime';
                }

                /**
                 * 是否使用时间区间
                 * @type {jQuery}
                 */
                let range = $(this).attr('range');
                if (range === '') {
                    range = false;
                }

                /**
                 * 绑定时间插件
                 */
                layui.use('laydate', function () {
                    let laydate = layui.laydate;
                    //日期时间范围
                    laydate.render({
                        elem: '#' + id,
                        type: dateFormat,
                        range: range
                    });
                });

                /**
                 * 用于区别id值
                 */
                date_time_input_num++;
            })
        })();

        var province_id = '';
        window.form.on('select(province_id)', function (data) {
            province_id = data.value;
            changeCity(province_id);
        });

        window.form.on('select(city_id)', function (data) {
            changeArea(province_id, data.value);
        });

        function changeCity(province_id) {

            let data = REGION[province_id];
            if (data === undefined) {
                return false;
            }

            let children = data.children;

            if (children === undefined) {
                return false;
            }

            let option = '<option value="">请选择市</option>';
            for (let i in children) {
                let data = children[i];
                option += '<option value="' + data.id + '">' + data.name + '</option>';
            }

            $('[name=city_id]').html(option);

            window.form.render();
        }

        function changeArea(province_id, city_id) {
            console.log(province_id, city_id);
            let children = REGION[province_id]['children'][city_id]['children'];
            if (children === undefined) {
                return false;
            }

            let option = '<option value="">请选择县/区</option>';
            for (let i in children) {
                let data = children[i];
                option += '<option value="' + data.id + '">' + data.name + '</option>';
            }

            $('[name=area_id]').html(option);

            window.form.render();
        }

        if ($('textarea.editor').length > 0) {
            require(['ZeroClipboard'], function (ZeroClipboard) {
                window.ZeroClipboard = ZeroClipboard;
                $('textarea.editor').map(function () {
                    console.log($(this).attr('id'));
                    var ue = UE.getEditor($(this).attr('id'));
                });
            })
        }

        window.form.render();
    });
</script>